<!DOCTYPE html>
<html>

<head>
    <title>Maquina de Cortes</title>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #000000;
            color: rgb(199, 199, 199);
            margin: 0;
            padding: 0;
        }

        #banner {
            background-color: rgb(56, 56, 56);
            color: #b3b3b3;
            padding: 1px;
            text-align: center;
        }

        #menu,
        #menu1 {
            background-color: #444444;
            color: #fff;
            text-align: center;
            padding: 2px;
        }

        #menu button,
        #menu1 button {
            background-color: #666;
            color: #fff;
            border: none;
            padding: 5px 10px;
            margin: 2px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        #menu button:hover #menu1 button:hover {
            background-color: #33343b;
        }

        #menu2 {
            background-color: #333;
            color: #ccc;
            text-align: center;
            padding: 2px;
        }

        #menu2 button {
            background-color: #616161b4;
            color: #e2e2e2;
            border: none;
            padding: 3px 6px;
            margin: 5px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        #menu2 button:hover {
            background-color: #465750;
        }

        #content,
        #formHorizontal,
        #horizontalOptions,
        #formModoProlijo,
        #formModoVelocidad,
        #horizontalReglamediaOptions {
            display: none;
            background-color: #333;
            padding: 20px;
            text-align: center;
            margin: 20px auto;
            max-width: 400px;
            border-radius: 10px;
        }

        #content,
        #formHorizontal,
        #horizontalOptions,
        #rebajeHorizontalOpcion,
        #formModoProlijo,
        #formModoVelocidad,
        #horizontalReglamediaOptions {
            display: none;
            background-color: #333;
            padding: 5px;
            text-align: center;
            margin: 5px auto;
            max-width: 400px;
            border-radius: 5px;
        }

        #content4 {
            display: none;
            background-color: #333;
            padding: 20px;
            text-align: center;
            margin: 20px auto;
            max-width: 600px;

        }

        .Box {
            display: none;
            width: 400px;
            height: 1px;
            background-color: #979797;
            max-width: 580px;
            margin-top: 50px;
            margin: 0 auto;
            border-radius: 1px;
            border-color: rgb(71, 68, 62);
            border: 10px;
            border: 2px solid rgb(32, 28, 28);

        }

        .Box2 {
            display: none;
            margin: 0px;
            margin-top: 1px;
            width: 400px;
            height: 0px;
            background-color: #000000;
            border: 1px solid rgb(90, 87, 87);
        }


        .Box3 {
            display: none;
            width: 400px;
            height: 200px;
            background-color: #979797;
            max-width: 580px;
            margin-top: 50px;
            margin: 0 auto;
            border-radius: 1px;
            border-color: rgb(71, 68, 62);
            border: 10px;
            border: 2px solid rgb(32, 28, 28);
            position: relative;

        }

        .Box4 {
            display: none;
            background-color: #000000;
            border: 1px solid rgb(90, 87, 87);

        }

        .Box5 {
            display: none;
            background-color: rgba(75, 150, 61, 0.412);
            border: 1px solid rgb(90, 87, 87);

        }

        .Box6 {

            display: none;
            background-color: rgba(255, 0, 0, 0.123);
            border: 1px solid rgb(90, 87, 87);
            position: absolute;
            bottom: 0px;
        }

        input[type='number'] {
            width: 60%;
            padding: 10px;
            border: 1px solid #ccc;
            background: rgb(158, 157, 157);
            margin-bottom: 10px;
            border-radius: 5px;
            color: #000000;
            font-size: 20px;
        }


        input[type='number']:focus {
            border: 1px solid #fff;
            background: rgb(151, 148, 148);
        }

        #submit-button {
            background-color: #666;
            color: #33cc33;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
        }


        #PanelDeEstado,
        #PanelDeMedicion {
            display: none;
            position: absolute;
            left: 15%;
            right: 15%;
            top: 100;
            bottom: 5;
            height: min-content;
            margin: auto;
            color: #d8c6c6b9;
            font-size: 18px;
            text-align: center;
            border: 2px solid #d11818d7;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 0 10px rgba(211, 155, 155, 0.801);
            z-index: 5;
            background-color: rgb(0, 0, 0);
        }

        #listaDeCortes {
            display: inline-block;
            /* Cambiado de block a inline-block */
            position: absolute;
            left: 5%;
            right: 5%;
            bottom: 5%;
            /* Ajustado para pegar el elemento al borde inferior */
            height: max-content;
            color: #d8c6c6b9;
            font-size: 14px;
            line-height: 6%;
            /* Valor ajustado para reducir el espacio entre líneas */
            text-align: center;
            border: 2px solid #d11818d7;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 0 10px rgba(211, 155, 155, 0.801);
            z-index: 0;
            background-color: rgb(0, 0, 0);
        }

        #listaDeCortes-dato0 {
            font-size: 18px;
            color: #f0eaea;

        }

        #PanelDeEstado div:first-child {
            margin-top: -20px;
        }

        #PanelDeEstado {
            column-count: 2;
            column-gap: 5px;
        }

        #PanelDeEstado div {
            break-inside: avoid;
        }

        .modalConfig {
            width: 100%;
            max-width: 500px;
            background-color: rgb(218, 216, 216);
            border-radius: 5px;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
            height: 200px;
            display: none;
        }
    </style>
</head>

<body>
    <div id='banner'>
        <h2>Seccionadora Vertical</h2>
    </div>
    <div id='menu'>
        <button onclick='showForm(101),ActivoModo_V()'>Corte Vertical !! </button>
        <button onclick='showHorizontalOptions(20)'>Corte Horizontal -> </button>
        <button onclick='sendoptionForm(5)'>Cargar Placa ° </button>
        <button onclick='showHorizontalRebajeOptions()'>Modo Rebaje H </button>
        <button onclick='sendoptionForm()'>Refilar</button>
    </div>
    </div>
    <div id='menu1'>
        <button onclick='BotonMedicion()'>Medir Placa |--|</button>
        <button onclick='sendoptionForm(26)'>regla media OFF</button>
        <button onclick='Agregarespera()'> Agregar una pausa</button>
        <button onclick='Pausarlista()'>Pausar || Continuar |> </button>

    </div>

    <div id='menu2'>
        <button onclick='showModoProlijo()'>Modo Prolijo</button>
        <button onclick='formModoVelocidad()'>Velocidad</button>
        <button onclick='sendoptionForm(9)'>Reset</button>
        <button onclick='actualizarpanel()'>Actualizar panel</button>
        <button onclick='showModalConfig()'>Configuracion</button>

    </div>

    <div id='content'>
        <form id='corteForm'>
            <input type='number' name='valor' step='0.1' placeholder='Ingrese la medida' id='valor_input'>
            <input type='hidden' name='accion' id='accion_input'>
            <button type='submit' name='enviar' id='submit-button'>OK</button>
        </form>
        <div class="Box3">
            <div class="Box4">
                <div class="Box5"></div>
            </div>
            <div class="Box6"></div>
        </div>
    </div>

    <div id='content4'>
        <form action='/rebajeH' method='POST' id='miFormulario'>
            <div>
                <label for='valor1'>Altura de placa:</label>
            </div>
            <div>
                <input type='number' name='Altura' step='0.1' placeholder='Altura de placa' id='valor1'>
            </div>
            <div>
                <label for='valor2'>Margen de separacion entre el borde y el inicio del rebaje:</label>
            </div>
            <div>
                <input type='number' name='margen' step='0.1' placeholder='Margen' id='valor2'>
            </div>
            <div>
                <label for='valor3'>Ancho total del rebaje :</label>
            </div>
            <div>
                <input type='number' name='ancho' step='0.1' placeholder='Ancho del rebaje' id='valor3'>
            </div>
            <div>
                <label for='valor4'>Profundidad del rebaje:</label>
            </div>
            <div>
                <input type='number' name='profundidad' step='0.1' placeholder='Profundidad' id='valor4'>
            </div>
            <input type='hidden' name='accion' id='accion_input2'>
            <button type='submit' name='enviar'>Enviar</button>
        </form>
        <div class="Box">
            <div class="Box2"> </div>
        </div>
    </div>

    <div id="horizontalOptions">
        <button onclick='Apagoreglamedia(26),showForm(21),ActivoModo_H1()'>Desde Abajo</button>
        <button onclick='Apagoreglamedia(26),showForm(22),ActivoModo_H2()'>Desde Arriba</button>
        <button onclick='showhorizontalReglamediaOptions(25),ActivoModo_H3()'>Sobre Regla Media</button>
    </div>
    <div id="horizontalReglamediaOptions">
        <button onclick='showForm(23)'>Desde Regla</button>
        <button onclick='showForm(24)'>Desde Arriba</button>
    </div>
    <div id="formModoProlijo">
        <button onclick='sendoptionForm(31)'>1 pasada de sierra</button>
        <button onclick='sendoptionForm(32)'>2 pasadas de sierra</button>
    </div>
    <div id="formModoVelocidad">
        <button onclick='sendoptionForm(41)'>Velocidad Baja</button>
        <button onclick='sendoptionForm(42)'>Velocidad Normal</button>
        <button onclick='sendoptionForm(43)'>Velocidad Rapida</button>
    </div>
    <div id="rebajeHorizontalOpcion">
        <button onclick='showImputRebajeH(71)'>Desde Abajo</button>
        <button onclick='showImputRebajeH(73)'>Desde Regla</button>
    </div>
    <div id="PanelDeEstado">
        <div>
            <p>Modo </p>
            <p id="panelDeEstado-modoProlijo">--</p>
        </div>
        <div>
            <p>Velocidad</p>
            <p id="panelDeEstado-velocidad">--</p>
        </div>
        <div>
            <p>Ultimo corte Vertical</p>
            <p id="panelDeEstado-Ultimo_Corte_V">--</p>
        </div>
        <div>
            <p>Ultimo corte Horizontal</p>
            <p id="panelDeEstado-Ultimo_Corte_H">--</p>
        </div>
        <div>
            <p>temperatura</p>
            <p id="panelDeEstado-Temperatura">--</p>
        </div>
        <div>
            <p>Posicion CP</p>
            <p id="panelDeEstado-Pos_CP">--</p>
        </div>
        <div>
            <p>Posicion CV</p>
            <p id="panelDeEstado-Pos_CV">--</p>
        </div>
        <div>
            <p>Posicion CT</p>
            <p id="panelDeEstado-Pos_CT">--</p>
        </div>
        <div>
            <p>Posicion TVV</p>
            <p id="panelDeEstado-Pos_TVV">--</p>
        </div>
        <div>
            <p>Posicion TVH</p>
            <p id="panelDeEstado-Pos_TVH">--</p>
        </div>
        <div>
            <p>Regla media</p>
            <p id="panelDeEstado-Regla_Media">--</p>
        </div>
        <div>
            <p>Reporte de error</p>
            <p id="panelDeEstado-Error">--</p>
        </div>
    </div>
    <div class="modalConfig" id="modalConfig">
        <form id="modalConfig-form">
            <select name="configId" id="configId">
            </select>
            <input name="valor" type="number" step='0.01' required id="modalConfigInput">
            <button>Actualizar</button>
        </form>
    </div>
    </div>

    <div id="PanelDeMedicion">
        <div>
            <p>Medicion de Placa </p>
            <p id="PanelDeMedicion-dato">Esperando medicion</p>
        </div>
    </div>

    <div id="listaDeCortes">
        <div>
            <p>Accion actual:</p>
            <p id="listaDeCortes-dato0">--</p>
            <p id="listaDeCortes-dato00">>> >></p>
            <p>Proximos cortes en lista </p>
            <p id="listaDeCortes-dato1">--</p>
            <p id="listaDeCortes-dato2">--</p>
            <p id="listaDeCortes-dato3">--</p>
            <p id="listaDeCortes-dato4">--</p>
            <p id="listaDeCortes-dato5">--</p>
            <p id="listaDeCortes-dato6">--</p>
            <p id="listaDeCortes-dato7">--</p>
            <p id="listaDeCortes-dato8">--</p>
        </div>
    </div>

    <script>

        //decalracion de variables y constantes 
        // tiempos de ejecucion y reitentos
        var contador = 0;
        var ms = 5000;
        var contador_consulta = 0;
        //--------------------------------------------------------
        // Array y objetos de listas de guardado y ejecucion
        let listaDeCortes = [];
        let posicion_de_guardado = 0;
        let posicion_de_ejecucion = 0;
        let proceso_de_corte_finalizado = true;
        let fetch_consulta = false;
        var accion_nombre = "indefinida"
        let regla_media_activada = false;
        var Modo = "Vertical";
        var Espera_De_30seg = false;
        let tiempo_de_espera = 0;
        let En_espera = false;
        let pausar_lista = false;
        let Tiempo_Actualizacion_lista = 5000;
        //--------------------------------------------------------

        const corteForm = document.getElementById('corteForm')
        corteForm.onsubmit = handleCorteForm

        const accionInputvalor = document.getElementById('valor_input');

        function handleCorteForm(event) {

            event.preventDefault() // prevenir el comportamiento por defecto
            NOshowOptions(['horizontalOptions', 'formModoProlijo', 'content', 'rebajeHorizontalOpcion', 'formModoVelocidad', 'PanelDeMedicion', 'PanelDeEstado']);

            const valor = event.target[0].value
            const accion = parseInt(event.target[1].value)
            const eepromDir = 0;
            const margen = 0;
            const ancho = 0;
            const profundidad = 0;
            const Solicitud_Medicion = false

            procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);

            event.target.reset()
        }

            function BotonMedicion() {

            NOshowOptions(['horizontalOptions', 'formModoProlijo', 'content', 'rebajeHorizontalOpcion', 'formModoVelocidad', 'PanelDeMedicion', 'PanelDeEstado']);

            const valor = "Accion/ "
            const accion = 10;
            const eepromDir = 0;
            const margen = 0;
            const ancho = 0;
            const profundidad = 0;
            const Solicitud_Medicion = true;

            procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);

            }


        function procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion, Espera_De_30seg_OBJ) {

            switch (accion) {

                case 101:
                    accion_nombre = "Corte vertical"
                    break;
                case 202:
                    accion_nombre = "Pausa Agregada por el usuario"
                    break;
                case 5:
                    accion_nombre = "Cargar placa"
                    break;
                case 9:
                    accion_nombre = "REINICIO DE Seccionadora"
                    break;
                case 10:
                    accion_nombre = "Medicion de placa"
                    break;
                case 20:
                    accion_nombre = "Preparar para corte Horizontal"
                    break;
                case 21:
                    accion_nombre = "Corte Horizontal desde abajo"
                    break;
                case 22:
                    accion_nombre = "Corte horizontal desde arriba"
                    break;
                case 23:
                    accion_nombre = "Corte horizontal Sobre Regla"
                    break;
                case 24:
                    accion_nombre = "horiz. sobre regla, desde arriba"
                    break;
                case 25:
                    accion_nombre = "Desplegar regla media"
                    break;
                case 26:
                    accion_nombre = "Desactivar regla Media"
                    break;
                case 31:
                    accion_nombre = "Set: 1 pasada de sierra"
                    break;
                case 32:
                    accion_nombre = "Set: 2 pasadas de sierra"
                    break;
                case 41:
                    accion_nombre = "Set: Velocidad Baja"
                    break;
                case 42:
                    accion_nombre = "Set: Velocidad Normal"
                    break;
                case 43:
                    accion_nombre = "Set: Velocidad Rapida"
                    break;
                case 71:
                    accion_nombre = "Rebaje, desde Abajo"
                    break;
                case 73:
                    accion_nombre = "Rebaje, desde regla"
                    break;
                default:
                    accion_nombre = "Desconocido"
                    break;
            }

            let objectoDeCorte = {};

            objectoDeCorte["valor"] = valor;
            objectoDeCorte["accion"] = accion;
            objectoDeCorte["eepromDir"] = 0;
            objectoDeCorte["margen"] = 0;
            objectoDeCorte["ancho"] = 0;
            objectoDeCorte["profundidad"] = 0;
            objectoDeCorte["a_procesar"] = true;
            objectoDeCorte["Solicitud_Medicion"] = Solicitud_Medicion;
            objectoDeCorte["accion_nombre"] = accion_nombre;
            objectoDeCorte["posicion_de_guardado_Obj"] = posicion_de_guardado;
            objectoDeCorte["Espera_30Seg"] = Espera_De_30seg_OBJ;


            // meter objetoDeCOrte a listaDeCortes
            listaDeCortes[posicion_de_guardado] = objectoDeCorte;
            posicion_de_guardado++;
            console.log(listaDeCortes);

            actualizarListaProximosCortes();
        }


        function procesadorDeCortes() {
            console.log("proceso pero no entro em if lista de corte");

            var tamañoLista = listaDeCortes.length;

            if ((tamañoLista > 0) && (tamañoLista > posicion_de_guardado - 1) && (posicion_de_ejecucion < tamañoLista)) {
                console.log("Dentro de if tamañoLista >=  posicion_de_ejecucion:");
                console.log(tamañoLista);
                console.log(posicion_de_ejecucion);

                if (listaDeCortes[posicion_de_ejecucion]["a_procesar"]) {

                    //hay que hacer una analisis aca, porque es probanle que este falando eso
                    console.log("Dentro de lista d cortes a_procesar, envio:");
                    console.log(listaDeCortes[posicion_de_ejecucion]);

                    const valor = listaDeCortes[posicion_de_ejecucion].valor;
                    const accion = listaDeCortes[posicion_de_ejecucion].accion;
                    const eepromDir = listaDeCortes[posicion_de_ejecucion].eepromDir;
                    const margen = listaDeCortes[posicion_de_ejecucion].margen;
                    const ancho = listaDeCortes[posicion_de_ejecucion].ancho;
                    const profundidad = listaDeCortes[posicion_de_ejecucion].profundidad;
                    const posicion_de_guardado_Obj = listaDeCortes[posicion_de_ejecucion].posicion_de_guardado_Obj

                    listaDeCortes[posicion_de_ejecucion]["a_procesar"] = false;
                    //proceso_de_corte_finalizado = false;
                    actualizarListaProximosCortes();
                    fetch_consulta = false;

                    //-----si el pedido es de medicion, ejecuto el fetch medicion y no ejcuto el fecth corte 
                    if (listaDeCortes[posicion_de_ejecucion]["Solicitud_Medicion"]) {
                        fetchmedicion(fetch_consulta);
                    } else {
                        fetchcorte(valor, accion, eepromDir, margen, ancho, profundidad, posicion_de_guardado_Obj, posicion_de_ejecucion, fetch_consulta);
                    }
                }
            }
        }

        function wait(ms) {
            return new Promise(resolve => setTimeout(resolve, ms))
        }

        function fetchcorte(valor, accion, eepromDir, margen, ancho, profundidad, posicion_de_guardado_Obj, posicion_de_ejecucion_OBJ, fetch_consulta_Obj) {

            var tamañoLista = listaDeCortes.length;

            console.log("Enviando al server")
            console.log("valor, accion, eepromDir, margen, ancho, profundidad, posicion_de_guardado_Obj, posicion_de_ejecucion, fetch_consulta")
            console.log(valor, accion, eepromDir, margen, ancho, profundidad, posicion_de_guardado_Obj, posicion_de_ejecucion_OBJ, fetch_consulta_Obj)

            actualizarListaProximosCortes();
            
                  fetch('http://192.168.0.123/corte', {
            
                    method: 'POST',
                    headers: {
                      'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `valor=${valor}&accion=${accion}&eepromDir=${eepromDir}&margen=${margen}&ancho=${ancho}&profundidad=${profundidad}$posicion_de_guardado_Obj=${posicion_de_guardado_Obj}$pos_de_ejec_Obj=${posicion_de_ejecucion_OBJ}`
            
                  }).then(response => {
                    console.log("respuesta del server; ")
                    console.log(response)
                    contador = 0;
                    if (!fetch_consulta_Obj) {
                      posicion_de_ejecucion++;
                      proceso_de_corte_finalizado = false;
                    } else if (fetch_consulta_Obj) {
                      proceso_de_corte_finalizado = true;
                      fetch_consulta = false;
                    }
                  })
                    .catch(async (error) => {
                      if (contador < 4) {
                        await wait(ms);
                        console.log("reenviando el fetch ")
                        console.log("valor, accion, eepromDir, margen, ancho, profundidad, posicion_de_guardado_Obj, posicion_de_ejecucion, fetch_consulta")
                        console.log(valor, accion, eepromDir, margen, ancho, profundidad, posicion_de_guardado_Obj, posicion_de_ejecucion_OBJ, fetch_consulta_Obj)
                        fetchcorte(valor, accion, eepromDir, margen, ancho, profundidad, posicion_de_guardado_Obj, posicion_de_ejecucion_OBJ, fetch_consulta_Obj);
                        contador++;
                      } else {
                        contador = 0;
                      }
                    });
            
                       /*
            if (!fetch_consulta_Obj) {
                posicion_de_ejecucion++;
                proceso_de_corte_finalizado = false;

            } else if (fetch_consulta_Obj) {
                proceso_de_corte_finalizado = true;
                fetch_consulta = false;
            }
             if(tamañoLista > posicion_de_ejecucion){
                  Tiempo_Actualizacion_lista = 500;
                  }else if (tamañoLista == posicion_de_ejecucion){
                  Tiempo_Actualizacion_lista = 5000;
                  }*/

            actualizarListaProximosCortes();
        }
         
        async function fetchmedicion(fetch_consulta_Obj) {
     
            //idear como hacer el envio del pedido y luego la espera.
            console.log("ESTOY EN FETCH MEDICION");
            
            if (!fetch_consulta_Obj) {
                      posicion_de_ejecucion++;
                      proceso_de_corte_finalizado = false;
                    } 

            actualizarListaProximosCortes()      
           
            const Medicion = document.getElementById('PanelDeMedicion-dato')
            Medicion.innerText = "esperando...";

            const PanelDeMedicion = document.getElementById('PanelDeMedicion');
            PanelDeMedicion.style.display = 'block';

            NOshowOptions(['horizontalOptions', 'content', 'formModoVelocidad', 'modalConfig', 'rebajeHorizontalOpcion', 'formModoProlijo']);

            //const response = await fetch('http://192.168.0.123/panelmedicion').catch(console.error)
            //const body = await response.json()
            
            //console.log(body.Medicion)

                 console.log("En display ");



                 const formContainer = document.getElementById('content');
                 formContainer.style.display = 'block';
                 const formContainer2 = document.getElementById('corteForm');
                 formContainer2.style.display = 'none';



                 box1_1.style.display = 'block'
                                  
                    box3_1.style.display = 'block'
                    /*box4_1.style.display = 'block'
                    box5_1.style.display = 'block'
                    box6_1.style.display = 'block'
                    box3_1.style.display = 'block'
                    box4_1.style.display = 'block'
                    box5_1.style.display = 'block'*/
                    

                box3_1.style.height = (Placa_Ancho / Coeficiente_reduccion) + 'px'
                box3_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box4_1.style.marginTop = 1 + 'px'
                box4_1.style.marginLeft = (Placa_Maximo / Coeficiente_reduccion) - 500 + 'px'
                box4_1.style.width = Grosor_linea_corte + 'px'
                box4_1.style.height = (Placa_Ancho / Coeficiente_reduccion) + 'px'
                box5_1.style.marginTop = 0 + 'px'
                box5_1.style.height = (Placa_Ancho / Coeficiente_reduccion) - 6 + 'px'
                box5_1.style.marginLeft = 1 + 'px'
                box5_1.style.width = (200 - 1) + 'px'
                box6_1.style.display = 'block'

            
            //Medicion.innerText = body.Medicion
        }

        function Pausarlista() {
            if (pausar_lista) {
                pausar_lista = false;
                alert("lista en proceso >> >>");
            } else {
                pausar_lista = true;
                alert("lista pausada - ulimo corte enviado " + listaDeCortes[posicion_de_ejecucion - 1].valor + "mm " + listaDeCortes[posicion_de_ejecucion - 1].accion_nombre);
            }

        }

        function Agregarespera() {

            Espera_De_30seg = true;

            const valor = "Accion/ "
            const accion = 202;
            const eepromDir = 0;
            const margen = 0;
            const ancho = 0;
            const profundidad = 0;
            const Solicitud_Medicion = false
            const Espera_De_30seg_OBJ = Espera_De_30seg

            procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion, Espera_De_30seg_OBJ);

            Espera_De_30seg = false;

            // ----------------------------
            //Logica para la espera
            //-----------------------------
        }

    </script>

    <script>

        const rebajeForm = document.getElementById('miFormulario')
        rebajeForm.onsubmit = handlerebajeForm

        function handlerebajeForm(event) {
            event.preventDefault() // prevenir el comportamiento por defecto


            const valor = event.target.Altura.value
            const accion = event.target.accion.value
            const eepromDir = 0;
            const margen = event.target.margen.value
            const ancho = event.target.ancho.value
            const profundidad = event.target.profundidad.value
            const Solicitud_Medicion = false

            procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);


            //enviar al array
            NOshowOptions(['horizontalOptions', 'content4', 'formModoProlijo', 'content', 'rebajeHorizontalOpcion', 'formModoVelocidad', 'PanelDeMedicion', 'PanelDeEstado']);
            event.target.reset()
        }

    </script>

    <script>


        actualizarListaauto();

        setInterval(actualizarListaauto, Tiempo_Actualizacion_lista);

        function actualizarListaauto() {


            if (!proceso_de_corte_finalizado) {
                var tamañoLista = listaDeCortes.length;
                console.log("en proceso_de_corte_finalizado")

                //contador_consulta++;

                if (tamañoLista > 0 && posicion_de_ejecucion <= tamañoLista) { //&& contador_consulta > 1) {
                    console.log("antes del fetch consulta")
                    fetch_consulta = true;
                    fetchcorte(0, 0, 0, 0, 0, 0, 0, 0, fetch_consulta);
                    //contador_consulta = 0;
                }
            } else {
                if (!pausar_lista) {
                    console.log("en pausar lista adennntro!")
                    var tamañoLista = listaDeCortes.length;

                    if (tamañoLista > 0 && posicion_de_ejecucion >= 0 && tamañoLista > posicion_de_ejecucion) {
                        //procesadorDeCortes();
                        if (listaDeCortes[posicion_de_ejecucion]["Espera_30Seg"]) {
                            pausar_lista = true;
                            alert("programa Pausado");
                            listaDeCortes[posicion_de_ejecucion]["Espera_30Seg"] = false;
                        } else {
                            procesadorDeCortes();
                        }
                    }
                }
            }
            actualizarListaProximosCortes();

        }

        function actualizarListaProximosCortes() {

            var tamañoLista = listaDeCortes.length;
            console.log("tamañoLista" + tamañoLista + ", pos de ej" + posicion_de_ejecucion);
            // - - - - - - - - - - - - - 
            // actualizo y muestro el corte actual 
            if (tamañoLista == 0) {
                const Medida0 = document.getElementById('listaDeCortes-dato0')
                Medida0.innerText = "No hay cortes pendientes";
            }
            else if (//(posicion_de_ejecucion == 0 && tamañoLista > 0 && posicion_de_ejecucion > 0) ||
            (posicion_de_ejecucion > 0 && posicion_de_ejecucion !== tamañoLista) ||
                            (!proceso_de_corte_finalizado && posicion_de_ejecucion === tamañoLista && tamañoLista > 0 && posicion_de_ejecucion > 0)) {
                const Medida0 = document.getElementById('listaDeCortes-dato0')
                Medida0.innerText = listaDeCortes[posicion_de_ejecucion - 1].valor + "mm " + listaDeCortes[posicion_de_ejecucion - 1].accion_nombre;
            }
            /*else if (posicion_de_ejecucion > 0 && posicion_de_ejecucion !== tamañoLista) {
                const Medida0 = document.getElementById('listaDeCortes-dato0')
                Medida0.innerText = listaDeCortes[posicion_de_ejecucion - 1].valor + "mm " + listaDeCortes[posicion_de_ejecucion - 1].accion_nombre;
            }*/
            else if (posicion_de_ejecucion == tamañoLista && proceso_de_corte_finalizado) {
                const Medida0 = document.getElementById('listaDeCortes-dato0')
                Medida0.innerText = "No hay cortes pendientes, ulitmo: " + listaDeCortes[posicion_de_ejecucion - 1].valor + "mm " + listaDeCortes[posicion_de_ejecucion - 1].accion_nombre;
            }
            if (tamañoLista > posicion_de_ejecucion) {
                const Medida1 = document.getElementById('listaDeCortes-dato1')
                Medida1.style.display = 'block'
                Medida1.innerText = listaDeCortes[posicion_de_ejecucion].valor + "mm " + listaDeCortes[posicion_de_ejecucion].accion_nombre;
            } else {
                const Medida1 = document.getElementById('listaDeCortes-dato1')
                Medida1.style.display = 'none'
                //Medida1.innerText = "--";
            }
            if (tamañoLista > posicion_de_ejecucion + 1) {
                const Medida2 = document.getElementById('listaDeCortes-dato2')
                Medida2.style.display = 'block'
                Medida2.innerText = listaDeCortes[posicion_de_ejecucion + 1].valor + "mm " + listaDeCortes[posicion_de_ejecucion + 1].accion_nombre;
            } else {
                const Medida2 = document.getElementById('listaDeCortes-dato2')
                Medida2.style.display = 'none'
                //Medida2.innerText = "--";
            }
            if (tamañoLista > posicion_de_ejecucion + 2) {
                const Medida3 = document.getElementById('listaDeCortes-dato3')
                Medida3.style.display = 'block'
                Medida3.innerText = listaDeCortes[posicion_de_ejecucion + 2].valor + "mm " + listaDeCortes[posicion_de_ejecucion + 2].accion_nombre;
            } else {
                const Medida3 = document.getElementById('listaDeCortes-dato3')
                Medida3.style.display = 'none'
                //Medida3.innerText = "--";
            }
            if (tamañoLista > posicion_de_ejecucion + 3) {
                const Medida4 = document.getElementById('listaDeCortes-dato4')
                Medida4.style.display = 'block'
                Medida4.innerText = listaDeCortes[posicion_de_ejecucion + 3].valor + "mm " + listaDeCortes[posicion_de_ejecucion + 3].accion_nombre;
            } else {
                const Medida4 = document.getElementById('listaDeCortes-dato4')
                Medida4.style.display = 'none'
                //Medida4.innerText = "--";
            }
            if (tamañoLista > posicion_de_ejecucion + 4) {
                const Medida5 = document.getElementById('listaDeCortes-dato5')
                Medida5.style.display = 'block'
                Medida5.innerText = listaDeCortes[posicion_de_ejecucion + 4].valor + "mm " + listaDeCortes[posicion_de_ejecucion + 4].accion_nombre;
            } else {
                const Medida5 = document.getElementById('listaDeCortes-dato5')
                Medida5.style.display = 'none'
                //Medida5.innerText = "--";
            }
            if (tamañoLista > posicion_de_ejecucion + 5) {
                const Medida6 = document.getElementById('listaDeCortes-dato6')
                Medida6.style.display = 'block'
                Medida6.innerText = listaDeCortes[posicion_de_ejecucion + 5].valor + "mm " + listaDeCortes[posicion_de_ejecucion + 5].accion_nombre;
            } else {
                const Medida6 = document.getElementById('listaDeCortes-dato6')
                Medida6.style.display = 'none'
                //Medida6.innerText = "--";
            }
            if (tamañoLista > posicion_de_ejecucion + 6) {
                const Medida7 = document.getElementById('listaDeCortes-dato7')
                Medida7.style.display = 'block'
                Medida7.innerText = listaDeCortes[posicion_de_ejecucion + 6].valor + "mm " + listaDeCortes[posicion_de_ejecucion + 6].accion_nombre;
            } else {
                const Medida7 = document.getElementById('listaDeCortes-dato7')
                Medida7.style.display = 'none'
                //Medida7.innerText = "--";
            }
            if (tamañoLista > posicion_de_ejecucion + 7) {
                const Medida8 = document.getElementById('listaDeCortes-dato8')
                Medida8.style.display = 'block'
                Medida8.innerText = listaDeCortes[posicion_de_ejecucion + 7].valor + "mm " + listaDeCortes[posicion_de_ejecucion + 7].accion_nombre;
            } else {
                const Medida8 = document.getElementById('listaDeCortes-dato8')
                Medida8.style.display = 'none'
                //Medida8.innerText = "--";
            }
            if (tamañoLista > posicion_de_ejecucion + 8) {
                const Medida8 = document.getElementById('listaDeCortes-dato8')
                Medida8.style.display = 'block'
                Medida8.innerText = "Existen cortes que aun no se muestran. ";
            }
        }

        //-----------------------------------------------------------------------------------------------------
        const fomrConfig = document.getElementById('modalConfig-form')
        fomrConfig.onsubmit = manejarFormConfig

        // -------------------------------------------
        // guardadode eprrom
        function manejarFormConfig(event) {
            event.preventDefault()

            console.log(event.target.configId.value);
            console.log(event.target[1].value);
            const campo = event.target.configId.value;
            const valor = event.target[1].value;

            fetch('http://192.168.0.123/config', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: `valor=${valor}&accion=${8}&accion2=${campo}`
            }).then(response => {
                alert("se guardo correctamente");

            }).catch(error => { alert("Error en la operacion de guardado en la eeprom"); });

            NOshowOptions(['horizontalOptions', 'rebajeHorizontalOpcion', 'formModoProlijo', 'content', 'modalConfig', 'formModoVelocidad', 'PanelDeMedicion', 'PanelDeEstado']);
        }




        function showModalConfig() {
            const modalConfig = document.getElementById('modalConfig');
            modalConfig.style.display = 'flex';
            NOshowOptions(['horizontalOptions', 'formModoProlijo', 'content', 'rebajeHorizontalOpcion', 'formModoVelocidad', 'PanelDeMedicion', 'PanelDeEstado']);
        }

        function Apagoreglamedia(option) {


            if (regla_media_activada) {

                const valor = "Accion /";
                const accion = option;
                const eepromDir = 0;
                const margen = 0;
                const ancho = 0;
                const profundidad = 0;
                const Solicitud_Medicion = false

                procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);
                regla_media_activada = false;
            }

        }

        function showForm(option) {

            const formContainer = document.getElementById('content');
            formContainer.style.display = 'block';

            const accionInput = document.getElementById('accion_input');
            accionInput.value = option;

            const valor = "Accion /";
            const accion = option;
            const eepromDir = 0;
            const margen = 0;
            const ancho = 0;
            const profundidad = 0;
            const Solicitud_Medicion = false

            NOshowOptions(['horizontalOptions', 'formModoProlijo', 'content4', 'formModoVelocidad', 'modalConfig', 'rebajeHorizontalOpcion', 'PanelDeMedicion', 'PanelDeEstado']);

            //procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);

        }

        function showImputRebajeH(option) {

            const formContainer = document.getElementById('content4');
            formContainer.style.display = 'block';

            const valor = 0;
            const accion = option;
            const eepromDir = 0;
            const margen = 0;
            const ancho = 0;
            const profundidad = 0;
            const Solicitud_Medicion = false

            NOshowOptions(['horizontalOptions', 'content', 'formModoProlijo', 'formModoVelocidad', 'modalConfig', 'rebajeHorizontalOpcion', 'PanelDeMedicion', 'PanelDeEstado']);

            procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);



        }

        function sendoptionForm(option) {

            const valor = "Accion /";
            const accion = option;
            const eepromDir = 0;
            const margen = 0;
            const ancho = 0;
            const profundidad = 0;
            const Solicitud_Medicion = false

            NOshowOptions(['horizontalOptions', 'content', 'formModoProlijo', 'formModoVelocidad', 'rebajeHorizontalOpcion', 'modalConfig', 'PanelDeMedicion', 'PanelDeEstado']);

            procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);

        }

        function showModoProlijo() {
            const formModoProlijo = document.getElementById('formModoProlijo');
            formModoProlijo.style.display = 'block';
            NOshowOptions(['horizontalOptions', 'content', 'formModoVelocidad', 'modalConfig', 'rebajeHorizontalOpcion', 'PanelDeMedicion', 'PanelDeEstado']);
        }

        async function actualizarpanel() {

            const PanelDeEstado = document.getElementById('PanelDeEstado');
            PanelDeEstado.style.display = 'block';

            NOshowOptions(['horizontalOptions', 'content', 'formModoVelocidad', 'modalConfig', 'rebajeHorizontalOpcion', 'PanelDeMedicion', 'formModoProlijo']);
            const response = await fetch('http://192.168.0.123/panel').catch(console.error)
            const body = await response.json()

            console.log(body.modoProlijo)
            console.log(body.velocidad)
            console.log(body.Ultimo_Corte_V)
            console.log(body.Ultimo_Corte_H)
            console.log(body.temperatura)
            console.log(body.Pos_CP)
            console.log(body.Pos_CV)
            console.log(body.Pos_CT)
            console.log(body.Pos_TVV)
            console.log(body.Pos_TVH)
            console.log(body.Regla_media)
            console.log(body.Error)

            const mP = document.getElementById('panelDeEstado-modoProlijo')
            mP.innerText = body.modoProlijo
            const vel = document.getElementById('panelDeEstado-velocidad')
            vel.innerText = body.velocidad
            const Ultimo_Corte_V = document.getElementById('panelDeEstado-Ultimo_Corte_V')
            Ultimo_Corte_V.innerText = body.Ultimo_Corte_V.toFixed(2)
            const Ultimo_Corte_H = document.getElementById('panelDeEstado-Ultimo_Corte_H')
            Ultimo_Corte_H.innerText = body.Ultimo_Corte_H.toFixed(2)
            const temp = document.getElementById('panelDeEstado-Temperatura')
            temp.innerText = body.temperatura.toFixed(2)
            const Pos_CP = document.getElementById('panelDeEstado-Pos_CP')
            Pos_CP.innerText = body.Pos_CP.toFixed(2)
            const Pos_CV = document.getElementById('panelDeEstado-Pos_CV')
            Pos_CV.innerText = body.Pos_CV.toFixed(2)
            const Pos_CT = document.getElementById('panelDeEstado-Pos_CT')
            Pos_CT.innerText = body.Pos_CT.toFixed(2)
            const Pos_TVV = document.getElementById('panelDeEstado-Pos_TVV')
            Pos_TVV.innerText = body.Pos_TVV.toFixed(2)
            const Pos_TVH = document.getElementById('panelDeEstado-Pos_TVH')
            Pos_TVH.innerText = body.Pos_TVH.toFixed(2)
            const Regla_Media = document.getElementById('panelDeEstado-Regla_Media')
            Regla_Media.innerText = body.Regla_Media
            const Error = document.getElementById('panelDeEstado-Error')
            Error.innerText = body.Error
        }

        function showHorizontalRebajeOptions(option) {

            const horizontalOptions = document.getElementById('rebajeHorizontalOpcion');
            horizontalOptions.style.display = 'block';
            const accionInput = document.getElementById('accion_input');
            accionInput.value = option;
            NOshowOptions(['formModoProlijo', 'content', 'formModoVelocidad', 'modalConfig', 'horizontalOptions', 'PanelDeMedicion', 'PanelDeEstado']);
            // mandar a guardar al array 
        }

        function showHorizontalOptions(option) {


            const horizontalOptions = document.getElementById('horizontalOptions');
            horizontalOptions.style.display = 'block';

            NOshowOptions(['formModoProlijo', 'content', 'rebajeHorizontalOpcion', 'formModoVelocidad', 'modalConfig', 'PanelDeMedicion', 'PanelDeEstado']);

            const valor = "Accion /";
            const accion = option;
            const eepromDir = 0;
            const margen = 0;
            const ancho = 0;
            const profundidad = 0;
            const Solicitud_Medicion = false

            procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);

        }

        function showhorizontalReglamediaOptions(option) {

            regla_media_activada = true;

            const horizontalreglamediaOptions = document.getElementById('horizontalReglamediaOptions');
            horizontalreglamediaOptions.style.display = 'block';

            const valor = "Accion /";
            const accion = option;
            const eepromDir = 0;
            const margen = 0;
            const ancho = 0;
            const profundidad = 0;
            const Solicitud_Medicion = false

            procesadorGuardado(valor, accion, eepromDir, margen, ancho, profundidad, Solicitud_Medicion);
        }

        function formModoVelocidad() {
            const formModoVelocidad = document.getElementById('formModoVelocidad');
            formModoVelocidad.style.display = 'block';

            NOshowOptions(['horizontalOptions', 'content', 'rebajeHorizontalOpcion', 'formModoProlijo', 'modalConfig', 'PanelDeMedicion', 'PanelDeEstado']);
        }

        function NOshowOptions(parametros) {
            for (let index = 0; index < parametros.length; index++) {
                const element = parametros[index];
                const nomostrar = document.getElementById(element);
                nomostrar.style.display = 'none';
            }
        }

    </script>
    <script>

        const CONFIG = [
            ['Espesor Sierra', 0],
            ['Recorrido Máximo TVH', 4],
            ['Profundidad Negativa Inscisor', 8],
            ['Despejar CT después del corte Vertical', 12],
            ['Recorrido Mínimo CP durante el corte H', 16],
            ['Velocidad de multiplicación en primera pasada', 20],
            ['Pasos CP', 24],
            ['Pasos CV', 28],
            ['Pasos CT', 32],
            ['Pasos TVH', 36],
            ['Pasos TVV', 40],
            ['Altura de corte mínima de CV', 48],
            ['Altura Corte máxima CV', 52],
            ['Altura ajuste de regla media', 56],
            ['Altura mínima sobre regla media', 60],
            ['Recorrido máximo CP durante el corte H', 64],
            ['Recorrido máximo CT', 68],
            ['Posición CP en corte V', 72],
            ['Posición CT en corte H', 76],
            ['Posición CP al usar función Refilar', 80],
            ['Posición CT al usar función Refilar', 84],
            ['Alarma de temperatura Máxima', 88],
            ['Zona Segura al activar Regla media', 92],
            ['Subir mínima CV durante corte V', 96],
            ['Subir CV post Fin de Detección de placa', 100],
            ['Delay Teclado', 104],
            ['Ajuste + Medicion Horizontal', 108],
            ['Ajuste - Medicion Horizontal', 112],
            ['Ajuste + Medicion Vertical', 116],
            ['Velocidad Inicio CP', 120],
            ['Velocidad Inicio CT', 124],
            ['Velocidad Inicio CV', 128],
            ['Velocidad Inicio TVH', 132],
            ['Velocidad Inicio TVV', 136],
            ['Aceleración general', 140],
            ['Velocidad CP Normal', 144],
            ['Velocidad CV Normal', 148],
            ['Velocidad CT Normal', 152],
            ['Velocidad TVH Normal', 156],
            ['Velocidad TVV Normal', 160],
            ['Velocidad Corte Vertical Baja', 168],
            ['Velocidad Corte Vertical Media', 172],
            ['Velocidad Corte Vertical Alta', 176],
            ['Velocidad Corte Horizontal Baja', 180],
            ['Velocidad Corte Horizontal Media', 184],
            ['Velocidad Corte Horizontal Alta', 188]
        ];

        const select = document.getElementById('configId')
        for (let index = 0; index < CONFIG.length; index++) {
            const element = CONFIG[index];
            const etiquetaoption = document.createElement('option')
            etiquetaoption.innerText = element[0]
            etiquetaoption.value = element[1]

            select.appendChild(etiquetaoption)
        }

        async function getConfig() {

            const configuracionASeleccionar = select.value
            const URL = 'http://192.168.0.123/config?id=' + configuracionASeleccionar
            const response = await fetch(URL)
            const body = await response.json()
            console.log(body)
            console.log(body.Valor_leido)
            const Input = document.getElementById('modalConfigInput')
            Input.value = body.Valor_leido.toFixed(2)
        }

        select.onchange = getConfig


        // -----------------------------------------------------------------------------
        // -----------------Simulador de cortes visual----------------------------------

        const inputHeight = document.getElementById('valor1')
        const box1_1 = document.getElementsByClassName('Box')[0]

        inputHeight.oninput = actualizarBox1Height

        function actualizarBox1Height() {
            const valor = inputHeight.value / 4
            box1_1.style.height = valor + 'px'
            box1_1.style.display = 'block'
        }

        const imputmargin = document.getElementById('valor2')
        const box1_2 = document.getElementsByClassName('Box2')[0]

        imputmargin.oninput = actualizarBox2margin

        function actualizarBox2margin() {
            const valor = imputmargin.value / 4
            box1_2.style.marginTop = valor + 'px'
            box1_2.style.display = 'block'
        }

        const imputancho = document.getElementById('valor3')
        const box1_3 = document.getElementsByClassName('Box2')[0]

        imputancho.oninput = actualizarBox2ancho

        function actualizarBox2ancho() {
            const valor = imputancho.value / 4
            box1_3.style.height = valor + 'px'
        }

        const inputHeight3 = document.getElementById('valor_input')
        const box3_1 = document.getElementsByClassName('Box3')[0]
        const box4_1 = document.getElementsByClassName('Box4')[0]
        const box5_1 = document.getElementsByClassName('Box5')[0]
        const box6_1 = document.getElementsByClassName('Box6')[0]

        const Coeficiente_reduccion = 10
        const Placa_Maximo = 2750
        const Placa_Ancho = 1830
        const Grosor_linea_corte = 2
        const Altura_regla_media = 500

        inputHeight3.oninput = actualizarBox3Height

        Modo_V = false
        Modo_H1 = false // H1 desde abajo
        Modo_H2 = false // H2 desde arriba
        Modo_H3 = false // H3 Sobre regla media

        function ActivoModo_V() {
            Modo_V = true
            Modo_H1 = false
            Modo_H2 = false
            Modo_H3 = false
        }
        function ActivoModo_H1() {
            Modo_V = false
            Modo_H1 = true
            Modo_H2 = false
            Modo_H3 = false
        }
        function ActivoModo_H2() {
            Modo_V = false
            Modo_H1 = false
            Modo_H2 = true
            Modo_H3 = false
        }
        function ActivoModo_H3() {
            Modo_V = false
            Modo_H1 = false
            Modo_H2 = false
            Modo_H3 = true
        }

        function actualizarBox3Height() {
            box3_1.style.display = 'block'
            box4_1.style.display = 'block'
            box5_1.style.display = 'block'

            const valorInput = document.getElementById('valor_input');
            const valorIngresado = valorInput.value;
            const valor = inputHeight3.value / Coeficiente_reduccion


            if (valorIngresado <= 0) {
                box5_1.style.display = 'none'
            }

            if (Modo_V) {

                box3_1.style.height = (Placa_Ancho / Coeficiente_reduccion) + 'px'
                box3_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box4_1.style.marginTop = 1 + 'px'
                box4_1.style.marginLeft = (Placa_Maximo / Coeficiente_reduccion) - valor + 'px'
                box4_1.style.width = Grosor_linea_corte + 'px'
                box4_1.style.height = (Placa_Ancho / Coeficiente_reduccion) + 'px'
                box5_1.style.marginTop = 0 + 'px'
                box5_1.style.height = (Placa_Ancho / Coeficiente_reduccion) - 6 + 'px'
                box5_1.style.marginLeft = 1 + 'px'
                box5_1.style.width = (valor - 1) + 'px'
                box6_1.style.display = 'none'

            } else if (Modo_H1) {

                box3_1.style.height = (Placa_Ancho / Coeficiente_reduccion) + 'px'
                box3_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box4_1.style.marginTop = (Placa_Ancho / Coeficiente_reduccion) - valor + 'px'
                box4_1.style.marginLeft = 0 + 'px'
                box4_1.style.height = Grosor_linea_corte + 'px'
                box4_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box5_1.style.marginLeft = 0 + 'px'
                box5_1.style.marginTop = 0 + 'px'
                box5_1.style.height = valor + 'px'
                box5_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box6_1.style.display = 'none'
            }

            else if (Modo_H2) {

                box3_1.style.height = (Placa_Ancho / Coeficiente_reduccion) + 'px'
                box3_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box4_1.style.marginTop = valor + 'px'
                box4_1.style.marginLeft = 0 + 'px'
                box4_1.style.height = Grosor_linea_corte + 'px'
                box4_1.style.width = (Placa_Maximo / Coeficiente_reduccion) - 4 + 'px'
                box5_1.style.marginLeft = 0 + 'px'
                box5_1.style.marginTop = -valor + 'px'
                box5_1.style.height = valor + 'px'
                box5_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box6_1.style.display = 'none'
            }

            else if (Modo_H3) {

                box3_1.style.height = (Placa_Ancho / Coeficiente_reduccion) + 'px'
                box3_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box6_1.style.display = 'block'
                box6_1.style.marginBottom = 0 + 'px'
                box6_1.style.marginLeft = 0 + 'px'
                box6_1.style.height = (Altura_regla_media / Coeficiente_reduccion) - 2 + 'px'
                box6_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
                box4_1.style.marginTop = (Placa_Ancho / Coeficiente_reduccion) - valor - (Altura_regla_media / Coeficiente_reduccion) + 'px'
                box4_1.style.marginLeft = 0 + 'px'
                box4_1.style.height = Grosor_linea_corte + 'px'
                box4_1.style.width = (Placa_Maximo / Coeficiente_reduccion) - 2 + 'px'
                box5_1.style.marginLeft = 0 + 'px'
                box5_1.style.marginTop = 0 + 'px'
                box5_1.style.height = valor + 'px'
                box5_1.style.width = (Placa_Maximo / Coeficiente_reduccion) + 'px'
            }
        }
    </script>
</body>

</html>
